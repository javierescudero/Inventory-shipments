<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<title>Inventory Shipments</title>
	<script type="text/javascript" src="js/jquery-1.12.4.min.js"></script>
	<script type="text/javascript" src="js/tableExport.js"></script>
	<script type="text/javascript" src="js/jquery.base64.js"></script>
	<script type="text/javascript" src="js/html2canvas.js"></script>
	<script type="text/javascript" src="js/jspdf/libs/sprintf.js"></script>
	<script type="text/javascript" src="js/jspdf/jspdf.js"></script>
	<script type="text/javascript" src="js/jspdf/libs/base64.js"></script>
</head>
<script type="text/javascript">
	$(document).ready(function(){

		$('#scan').focus();

		var array_pallet = new Array();
		var array_Q = new Array();
		var array_pN = new Array();
		var array_WO = new Array();

		var x = 0;
		var pall = array_pallet.length;
		var partNumb = 0;
		var boxes = 1;
		var boxesNP = 1;
		var piecesWO = 0;
		var piecesPN = 0;
		var piecesPNT = 0;

		$('#form').submit(function() {
			var c = $('#scan').val();

				if (c.charAt(0) == 'T') {
					var pallet = c.substring(1);
					$('#scan').val('');
					if (array_pallet[0] == null) {
						array_pallet.push(pallet);
					} else {
						var index = array_pallet.indexOf(pallet);
						if (index > -1) {
							alert('This pallet number already exists\nTry with other pallet number');
							return false;
						} else {
							array_pallet.push(pallet);
							pall++;
						}
					}
					//alert('Pallets = ' + (pall+1));
				} if (c.charAt(0) == 'Q') {
					var Q = c.substring(1);
					Q.replace(/0/,'');
					array_Q.push(Q);
					$('#scan').val('');

				}
				else if (c.charAt(0) == 'P') {
					var pN = c.substring(1);
					$('#scan').val('');
					if (array_pN[0] == null) {
						array_pN.push(pN);
						piecesPN = array_Q[0];
						piecesPNT = array_Q[0];
					} else {
						array_pN.push(pN);
						piecesPN = 0;
						piecesPNT = 0;
						boxesNP = 0;
						for (var i = 0; i < array_pN.length; i++) {
							if (pN == array_pN[i]) {
								piecesPN = parseInt(piecesPN) + parseInt(array_Q[i]);
								boxesNP++;
							} else {
							}
							piecesPNT = parseInt(piecesPNT) + parseInt(array_Q[i]);
						};
					}

				} else if (c.charAt(0) == 'W') {
					var WO = c.substring(1);
					$('#scan').val('');
					if (array_WO[0] == null) {
						array_WO.push(WO);
						piecesWO = array_Q[0];
					} else {
						array_WO.push(WO);
						piecesWO = 0;
						for (var i = 0; i < array_WO.length; i++) {
							if (WO == array_WO[i]) {
								piecesWO = parseInt(piecesWO) + parseInt(array_Q[i]);
							} else {
							}
						};
					}


					/*$('#body').append('<tr><td>'+array_pallet[pall]+'</td><td>'+array_pN[x]+'</td><td>'+array_Q[x]+'</td><td>'+array_WO[x]+'</td><td>'+piecesWO+'</td><td>'+piecesPN+'</td><td>'+boxes+'</td><td>'+parseInt(pall+1)+'</td></tr>');*/

					$('#format').append('<tr><td>'+array_pallet[pall]+'</td><td>'+array_pN[x]+'</td><td>'+array_WO[x]+'</td><td>'+boxesNP+'</td><td>'+parseInt(array_Q[x])+'</td><td>'+parseInt(piecesPN)+'</td></tr>');

					document.getElementById("totalTitle").innerHTML = '';
					document.getElementById("totalBoxes").innerHTML = boxes;
					document.getElementById("totalPallets").innerHTML = parseInt(pall+1);
					document.getElementById("totalPieces").innerHTML = parseInt(piecesPNT);

					boxes++;
					x++;
				}
			return false;
		});

		$('#saveData').click(function(){
			$('table').tableExport({type:'excel',escape:'false'});
		});
		$('#delete').click(function(){
			$('tbody').remove();
		});
	});
</script>
<body>
	<form id="form">
		<label for="scan">Scan: </label><input type="text" id="scan" name="scan" style="width:40%"><br><br>
		<input type="button" value="Guardar y Exportar" id="saveData"><input type="button" value="Borrar Informacion" id="delete"><br><br>
	</form>
	<div id="divData">

		<table id="dataFormat" cellpadding="1" cellspacing="1" border="1">
			<thead>
				<tr>
					<th><b>Pallets</b></th>
					<th><b>No. Parte</b></th>
					<th><b>WO</b></th>
					<th><b>Cajas</b></th>
					<th><b>Cantidad por Caja</b></th>
					<th><b>Cantidad Total</b></th>
				</tr>
			</thead>
			<tbody id="format">
			</tbody>
		</table><br>

		<table id="total" cellpadding="1" cellspacing="1" border="1">
			<thead>
				<tr>
					<th><b>Totales</b></th>
					<th><b>Pallets</b></th>
					<th><b>Cajas</b></th>
					<th><b>Piezas</b></th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td id="totalTitle"></td>
					<td id="totalPallets"></td>
					<td id="totalBoxes"></td>
					<td id="totalPieces"></td>
				</tr>
			</tbody>
		</table><br>
	</div>
</body>
</html>
